# üìÑ –†—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ –ø–æ —Å–æ–∑–¥–∞–Ω–∏—é —Å—Ç—Ä–∞–Ω–∏—Ü –≤ Confluence

## üéØ –û–±–∑–æ—Ä —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç–∏

–°–∏—Å—Ç–µ–º–∞ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç —Å–æ–∑–¥–∞–Ω–∏–µ —Å—Ç—Ä–∞–Ω–∏—Ü –≤ Confluence —á–µ—Ä–µ–∑ API —Å –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å—é:
- –°–æ–∑–¥–∞–Ω–∏—è –æ–±—ã—á–Ω—ã—Ö —Å—Ç—Ä–∞–Ω–∏—Ü
- –°–æ–∑–¥–∞–Ω–∏—è —Å—Ç—Ä–∞–Ω–∏—Ü –Ω–∞ –æ—Å–Ω–æ–≤–µ —à–∞–±–ª–æ–Ω–æ–≤
- –î–æ–±–∞–≤–ª–µ–Ω–∏—è –º–µ—Ç–æ–∫
- –£–∫–∞–∑–∞–Ω–∏—è —Ä–æ–¥–∏—Ç–µ–ª—å—Å–∫–æ–π —Å—Ç—Ä–∞–Ω–∏—Ü—ã
- –ü–æ–∏—Å–∫–∞ —Å—É—â–µ—Å—Ç–≤—É—é—â–∏—Ö —Å—Ç—Ä–∞–Ω–∏—Ü

## üîß –û–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–µ –ø–æ–ª—è –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è —Å—Ç—Ä–∞–Ω–∏—Ü—ã

### –ú–∏–Ω–∏–º–∞–ª—å–Ω–æ –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã–µ –ø–æ–ª—è:
```json
{
  "title": "–ó–∞–≥–æ–ª–æ–≤–æ–∫ —Å—Ç—Ä–∞–Ω–∏—Ü—ã",           // –û–ë–Ø–ó–ê–¢–ï–õ–¨–ù–û
  "content": "–°–æ–¥–µ—Ä–∂–∏–º–æ–µ —Å—Ç—Ä–∞–Ω–∏—Ü—ã",        // –û–ë–Ø–ó–ê–¢–ï–õ–¨–ù–û  
  "space_key": "DEV"                       // –û–ë–Ø–ó–ê–¢–ï–õ–¨–ù–û
}
```

### –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –ø–æ–ª—è:
```json
{
  "parent_id": "123456789",                // ID —Ä–æ–¥–∏—Ç–µ–ª—å—Å–∫–æ–π —Å—Ç—Ä–∞–Ω–∏—Ü—ã
  "template_id": "template-123",           // ID —à–∞–±–ª–æ–Ω–∞
  "template_data": {                       // –î–∞–Ω–Ω—ã–µ –¥–ª—è –∑–∞–ø–æ–ª–Ω–µ–Ω–∏—è —à–∞–±–ª–æ–Ω–∞
    "title": "–ó–∞–≥–æ–ª–æ–≤–æ–∫",
    "description": "–û–ø–∏—Å–∞–Ω–∏–µ",
    "date": "2024-01-01",
    "user": "username"
  },
  "labels": ["tag1", "tag2"],              // –ú–µ—Ç–∫–∏ —Å—Ç—Ä–∞–Ω–∏—Ü—ã
  "page_type": "page",                     // –¢–∏–ø —Å—Ç—Ä–∞–Ω–∏—Ü—ã (page, blogpost)
  "representation": "storage"              // –§–æ—Ä–º–∞—Ç —Å–æ–¥–µ—Ä–∂–∏–º–æ–≥–æ
}
```

## üåê API Endpoints

### 1. –°–æ–∑–¥–∞–Ω–∏–µ —Å—Ç—Ä–∞–Ω–∏—Ü—ã (–ø–æ–ª–Ω—ã–π –∑–∞–ø—Ä–æ—Å)
```http
POST /api/v1/confluence/pages
Content-Type: application/json

{
  "title": "–î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –ø–æ –∑–∞–¥–∞—á–µ 123456",
  "content": "<h1>–û–ø–∏—Å–∞–Ω–∏–µ –∑–∞–¥–∞—á–∏</h1><p>–î–µ—Ç–∞–ª—å–Ω–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ...</p>",
  "space_key": "DEV",
  "parent_id": "123456789",
  "template_id": "template-123",
  "labels": ["documentation", "task-123456"],
  "template_data": {
    "task_id": "123456",
    "assignee": "john.doe@company.com",
    "priority": "High"
  }
}
```

### 2. –ë—ã—Å—Ç—Ä–æ–µ —Å–æ–∑–¥–∞–Ω–∏–µ —Å—Ç—Ä–∞–Ω–∏—Ü—ã
```http
POST /api/v1/confluence/pages/quick-create?title=–ó–∞–≥–æ–ª–æ–≤–æ–∫&content=–°–æ–¥–µ—Ä–∂–∏–º–æ–µ&space_key=DEV&labels=tag1,tag2
```

### 3. –ü–æ–∏—Å–∫ —Å—Ç—Ä–∞–Ω–∏—Ü
```http
GET /api/v1/confluence/pages?query=–ø–æ–∏—Å–∫–æ–≤—ã–π –∑–∞–ø—Ä–æ—Å&space_key=DEV&limit=10
```

### 4. –ü–æ–ª—É—á–µ–Ω–∏–µ —à–∞–±–ª–æ–Ω–æ–≤
```http
GET /api/v1/confluence/templates?space_key=DEV
```

### 5. –ü–æ–ª—É—á–µ–Ω–∏–µ –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤
```http
GET /api/v1/confluence/spaces
```

## üìù –ü—Ä–∏–º–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è

### –ü—Ä–∏–º–µ—Ä 1: –°–æ–∑–¥–∞–Ω–∏–µ –ø—Ä–æ—Å—Ç–æ–π —Å—Ç—Ä–∞–Ω–∏—Ü—ã
```python
import requests

url = "http://localhost:8001/api/v1/confluence/pages/quick-create"
params = {
    "title": "–¢–µ—Å—Ç–æ–≤–∞—è —Å—Ç—Ä–∞–Ω–∏—Ü–∞",
    "content": "<h1>–ó–∞–≥–æ–ª–æ–≤–æ–∫</h1><p>–°–æ–¥–µ—Ä–∂–∏–º–æ–µ —Å—Ç—Ä–∞–Ω–∏—Ü—ã</p>",
    "space_key": "DEV",
    "labels": "test,documentation"
}

response = requests.post(url, params=params)
print(response.json())
```

### –ü—Ä–∏–º–µ—Ä 2: –°–æ–∑–¥–∞–Ω–∏–µ —Å—Ç—Ä–∞–Ω–∏—Ü—ã —Å —à–∞–±–ª–æ–Ω–æ–º
```python
import requests

url = "http://localhost:8001/api/v1/confluence/pages"
data = {
    "title": "–î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –ø–æ –∑–∞–¥–∞—á–µ 123456",
    "content": "<p>–ë–∞–∑–æ–≤–æ–µ —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ</p>",
    "space_key": "DEV",
    "template_id": "template-123",
    "template_data": {
        "task_id": "123456",
        "assignee": "john.doe@company.com",
        "priority": "High",
        "description": "–û–ø–∏—Å–∞–Ω–∏–µ –∑–∞–¥–∞—á–∏"
    },
    "labels": ["documentation", "task-123456"]
}

response = requests.post(url, json=data)
print(response.json())
```

### –ü—Ä–∏–º–µ—Ä 3: –ü–æ–∏—Å–∫ —Å—Ç—Ä–∞–Ω–∏—Ü
```python
import requests

url = "http://localhost:8001/api/v1/confluence/pages"
params = {
    "query": "–¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è",
    "space_key": "DEV",
    "limit": 10
}

response = requests.get(url, params=params)
print(response.json())
```

## üé® –†–∞–±–æ—Ç–∞ —Å —à–∞–±–ª–æ–Ω–∞–º–∏

### –°–æ–∑–¥–∞–Ω–∏–µ —Å—Ç—Ä–∞–Ω–∏—Ü—ã –Ω–∞ –æ—Å–Ω–æ–≤–µ —à–∞–±–ª–æ–Ω–∞

1. **–ü–æ–ª—É—á–µ–Ω–∏–µ —Å–ø–∏—Å–∫–∞ —à–∞–±–ª–æ–Ω–æ–≤:**
```http
GET /api/v1/confluence/templates
```

2. **–°–æ–∑–¥–∞–Ω–∏–µ —Å—Ç—Ä–∞–Ω–∏—Ü—ã —Å —à–∞–±–ª–æ–Ω–æ–º:**
```json
{
  "title": "–°—Ç—Ä–∞–Ω–∏—Ü–∞ —Å —à–∞–±–ª–æ–Ω–æ–º",
  "content": "<p>–ë–∞–∑–æ–≤–æ–µ —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ</p>",
  "space_key": "DEV",
  "template_id": "template-123",
  "template_data": {
    "title": "–ó–∞–≥–æ–ª–æ–≤–æ–∫",
    "description": "–û–ø–∏—Å–∞–Ω–∏–µ",
    "date": "2024-01-01",
    "user": "username",
    "project": "ProjectName",
    "task_id": "123456"
  }
}
```

### –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ —à–∞–±–ª–æ–Ω–∞

–°–∏—Å—Ç–µ–º–∞ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç —Å–ª–µ–¥—É—é—â–∏–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ:
- `{{title}}` - –∑–∞–≥–æ–ª–æ–≤–æ–∫
- `{{description}}` - –æ–ø–∏—Å–∞–Ω–∏–µ
- `{{date}}` - –¥–∞—Ç–∞
- `{{time}}` - –≤—Ä–µ–º—è
- `{{user}}` - –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å
- `{{project}}` - –ø—Ä–æ–µ–∫—Ç
- `{{task_id}}` - ID –∑–∞–¥–∞—á–∏
- `{{custom_variable}}` - –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ

## üîç –ü–æ–∏—Å–∫ –∏ —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏—è

### –ü–∞—Ä–∞–º–µ—Ç—Ä—ã –ø–æ–∏—Å–∫–∞:
- `query` - –ø–æ–∏—Å–∫–æ–≤—ã–π –∑–∞–ø—Ä–æ—Å (–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ)
- `space_key` - –∫–ª—é—á –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–∞ (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)
- `content_type` - —Ç–∏–ø –∫–æ–Ω—Ç–µ–Ω—Ç–∞: "page", "blogpost", "comment" (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é "page")
- `limit` - –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ (1-100, –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é 10)
- `start` - –Ω–∞—á–∞–ª—å–Ω–∞—è –ø–æ–∑–∏—Ü–∏—è –¥–ª—è –ø–∞–≥–∏–Ω–∞—Ü–∏–∏ (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é 0)

### –ü—Ä–∏–º–µ—Ä –ø–æ–∏—Å–∫–∞:
```http
GET /api/v1/confluence/pages?query=–¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è&space_key=DEV&content_type=page&limit=20
```

## üìä –§–æ—Ä–º–∞—Ç—ã —Å–æ–¥–µ—Ä–∂–∏–º–æ–≥–æ

### 1. Storage Format (HTML) - –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é
```html
<h1>–ó–∞–≥–æ–ª–æ–≤–æ–∫</h1>
<p>–ü–∞—Ä–∞–≥—Ä–∞—Ñ —Å <strong>–∂–∏—Ä–Ω—ã–º</strong> —Ç–µ–∫—Å—Ç–æ–º</p>
<ul>
  <li>–≠–ª–µ–º–µ–Ω—Ç —Å–ø–∏—Å–∫–∞ 1</li>
  <li>–≠–ª–µ–º–µ–Ω—Ç —Å–ø–∏—Å–∫–∞ 2</li>
</ul>
```

### 2. Wiki Format
```wiki
h1. –ó–∞–≥–æ–ª–æ–≤–æ–∫
* –≠–ª–µ–º–µ–Ω—Ç —Å–ø–∏—Å–∫–∞ 1
* –≠–ª–µ–º–µ–Ω—Ç —Å–ø–∏—Å–∫–∞ 2
```

### 3. Atlas Document Format
```json
{
  "type": "doc",
  "content": [
    {
      "type": "heading",
      "attrs": {"level": 1},
      "content": [{"type": "text", "text": "–ó–∞–≥–æ–ª–æ–≤–æ–∫"}]
    }
  ]
}
```

## üè∑Ô∏è –†–∞–±–æ—Ç–∞ —Å –º–µ—Ç–∫–∞–º–∏

### –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –º–µ—Ç–æ–∫:
```json
{
  "title": "–°—Ç—Ä–∞–Ω–∏—Ü–∞ —Å –º–µ—Ç–∫–∞–º–∏",
  "content": "<p>–°–æ–¥–µ—Ä–∂–∏–º–æ–µ</p>",
  "space_key": "DEV",
  "labels": ["documentation", "api", "test", "automation"]
}
```

### –ü–æ–∏—Å–∫ –ø–æ –º–µ—Ç–∫–∞–º:
```http
GET /api/v1/confluence/pages?query=label:documentation
```

## üîó –°–æ–∑–¥–∞–Ω–∏–µ –∏–µ—Ä–∞—Ä—Ö–∏–∏ —Å—Ç—Ä–∞–Ω–∏—Ü

### –°–æ–∑–¥–∞–Ω–∏–µ –¥–æ—á–µ—Ä–Ω–µ–π —Å—Ç—Ä–∞–Ω–∏—Ü—ã:
```json
{
  "title": "–î–æ—á–µ—Ä–Ω—è—è —Å—Ç—Ä–∞–Ω–∏—Ü–∞",
  "content": "<p>–°–æ–¥–µ—Ä–∂–∏–º–æ–µ –¥–æ—á–µ—Ä–Ω–µ–π —Å—Ç—Ä–∞–Ω–∏—Ü—ã</p>",
  "space_key": "DEV",
  "parent_id": "123456789"
}
```

## ‚ö†Ô∏è –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫

### –¢–∏–ø–∏—á–Ω—ã–µ –æ—à–∏–±–∫–∏:

1. **–û—à–∏–±–∫–∞ –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏ (401):**
```json
{
  "success": false,
  "error": "–û—à–∏–±–∫–∞ –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏: Invalid credentials"
}
```

2. **–û—à–∏–±–∫–∞ –≤–∞–ª–∏–¥–∞—Ü–∏–∏ (400):**
```json
{
  "success": false,
  "error": "–û—à–∏–±–∫–∞ –≤–∞–ª–∏–¥–∞—Ü–∏–∏: Title is required"
}
```

3. **–û—à–∏–±–∫–∞ –¥–æ—Å—Ç—É–ø–∞ (403):**
```json
{
  "success": false,
  "error": "–û—à–∏–±–∫–∞ –¥–æ—Å—Ç—É–ø–∞: Insufficient permissions"
}
```

4. **–û—à–∏–±–∫–∞ –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–∞ (404):**
```json
{
  "success": false,
  "error": "–ü—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–æ –Ω–µ –Ω–∞–π–¥–µ–Ω–æ: Space 'INVALID' does not exist"
}
```

## üöÄ –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç

### 1. –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è:
```bash
curl "http://localhost:8001/api/v1/status"
```

### 2. –ü–æ–ª—É—á–µ–Ω–∏–µ –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤:
```bash
curl "http://localhost:8001/api/v1/confluence/spaces"
```

### 3. –°–æ–∑–¥–∞–Ω–∏–µ –ø—Ä–æ—Å—Ç–æ–π —Å—Ç—Ä–∞–Ω–∏—Ü—ã:
```bash
curl -X POST "http://localhost:8001/api/v1/confluence/pages/quick-create" \
  -G -d "title=–¢–µ—Å—Ç–æ–≤–∞—è —Å—Ç—Ä–∞–Ω–∏—Ü–∞" \
  -d "content=<h1>–¢–µ—Å—Ç</h1><p>–°–æ–¥–µ—Ä–∂–∏–º–æ–µ</p>" \
  -d "space_key=DEV" \
  -d "labels=test,api"
```

### 4. –ü–æ–∏—Å–∫ —Å—Ç—Ä–∞–Ω–∏—Ü:
```bash
curl "http://localhost:8001/api/v1/confluence/pages?query=—Ç–µ—Å—Ç&space_key=DEV"
```

## üìã –ß–µ–∫-–ª–∏—Å—Ç –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è —Å—Ç—Ä–∞–Ω–∏—Ü—ã

- [ ] –£–∫–∞–∑–∞–Ω –∑–∞–≥–æ–ª–æ–≤–æ–∫ —Å—Ç—Ä–∞–Ω–∏—Ü—ã
- [ ] –£–∫–∞–∑–∞–Ω–æ —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ —Å—Ç—Ä–∞–Ω–∏—Ü—ã
- [ ] –£–∫–∞–∑–∞–Ω –∫–ª—é—á –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–∞
- [ ] –ü—Ä–æ–≤–µ—Ä–µ–Ω–æ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ Confluence
- [ ] –ü—Ä–æ–≤–µ—Ä–µ–Ω—ã –ø—Ä–∞–≤–∞ –¥–æ—Å—Ç—É–ø–∞ –∫ –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤—É
- [ ] –ü—Ä–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏ —É–∫–∞–∑–∞–Ω ID —Ä–æ–¥–∏—Ç–µ–ª—å—Å–∫–æ–π —Å—Ç—Ä–∞–Ω–∏—Ü—ã
- [ ] –ü—Ä–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏ —É–∫–∞–∑–∞–Ω ID —à–∞–±–ª–æ–Ω–∞
- [ ] –ü—Ä–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏ —É–∫–∞–∑–∞–Ω—ã –¥–∞–Ω–Ω—ã–µ –¥–ª—è —à–∞–±–ª–æ–Ω–∞
- [ ] –ü—Ä–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏ —É–∫–∞–∑–∞–Ω—ã –º–µ—Ç–∫–∏

## üîß –ù–∞—Å—Ç—Ä–æ–π–∫–∞

### –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è:
```env
CONFLUENCE_URL=https://your-confluence.atlassian.net
CONFLUENCE_USER=your-email@company.com
CONFLUENCE_TOKEN=your-api-token
```

### –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞—Å—Ç—Ä–æ–µ–∫:
```python
from app.config.settings import settings
print(f"Confluence URL: {settings.CONFLUENCE_URL}")
print(f"Confluence User: {settings.CONFLUENCE_USER}")
```

## üìö –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ —Ä–µ—Å—É—Ä—Å—ã

- [Confluence REST API Documentation](https://developer.atlassian.com/cloud/confluence/rest/)
- [Confluence Content Format](https://developer.atlassian.com/cloud/confluence/content-format/)
- [Confluence Templates](https://confluence.atlassian.com/doc/confluence-templates-139464.html)
