# Проект 219908: АкваТрейд. В МТ разделить долги ТТ по маршрутам

## Общая информация

| Параметр | Значение |
|----------|----------|
| **ID запроса** | 219908 |
| **Название** | АкваТрейд. В МТ разделить долги ТТ по маршрутам |
| **Статус** | В работе (Ожидание демо на UAT) |
| **Проект** | АкваТрейд |
| **Команда** | Foxtrot |
| **Приоритет** | 2 (Высокий) |
| **Дата создания** | 11.04.2025 |
| **Планируемая дата завершения** | 30.12.2025 |
| **Стоимость** | 286,068.35 ₽ |
| **Ответственный** | Оздоган Татьяна |
| **Заказчик** | Руднева Анастасия |

## Описание проблемы

### Бизнес-контекст
Торговые точки филиала присутствуют в маршрутах нескольких сотрудников разных фокусных команд. В настоящее время в МТ (Мобильном Терминале) виден общий долг по контрагенту, что создает неудобства для торговых агентов и супервайзеров.

### Проблемы
1. **Отсутствие детализации долгов**: Агенты видят общую задолженность по торговой точке, а не свою часть
2. **Невозможность адекватной оценки**: Сложно понять, какая часть долга относится к конкретному маршруту/позиции
3. **Неэффективное планирование**: Агенты не могут корректно планировать работу с торговыми точками

### Частота возникновения
Проблема возникает при каждом визите, сопровождающемся анализом ситуации с долгами.

## Цели и задачи

### Основная цель
Реализовать отображение долгов торговых точек в разрезе маршрутов/позиций в Мобильном Терминале.

### Задачи
1. **Разделение долгов по маршрутам**: Отображать в МТ задолженность в разрезе конкретного маршрута агента
2. **Стоп-лист по фокусным группам**: Реализовать стоп-лист торговых точек в разрезе фокусных групп
3. **Лимиты кредита**: Настроить проверку лимитов кредита в разрезе фокусной группы
4. **Отчетность**: Доработать отчеты "Долги" и "Взаиморасчеты" в МТ

## Техническое решение

### Архитектура решения
```
УС (Учетная система) → Чикаго (База данных) → МТ (Мобильный терминал)
```

### Ключевые компоненты
1. **Таблица `refOutletFocusGroups`**: Хранение лимитов кредита в разрезе фокусных групп
2. **Репликация данных**: Механизм передачи данных из УС в Чикаго
3. **Выгрузка в МТ**: Передача данных из Чикаго в мобильные терминалы
4. **Логика проверки**: Валидация лимитов кредита в разрезе фокусной группы

### Основные изменения
- Добавлено поле `idRoute` в регистр задолженностей
- Создана индивидуальная таблица для хранения лимитов по фокусным группам
- Реализована логика разделения долгов по маршрутам
- Настроена репликация с учетом фокусных групп

## Структура проекта

### Связанные тикеты

#### Родительский элемент
- **186545** - Функция "МТ" (Предложено)

#### Дочерние элементы
1. **220851** - HLD "АкваТрейд. В МТ разделить долги ТТ по маршрутам и стоп лист по ТТ" ✅ Готово
2. **228654** - TDD "АкваТрейд. В МТ разделить долги ТТ по маршрутам" ✅ Готово  
3. **231566** - RnD "Акватрейд репликация" ✅ Готово
4. **232419** - User Story "АкваТрейд. Стоп-лист в разрезе ФГ" ✅ Готово
5. **232420** - User Story "АкваТрейд. Задолженности в разрезе фокусной группы" ✅ Готово
6. **233454** - Backlog Item "UAT Акватрейд Долги по маршрутам. настройка + тестирование" ⏳ Одобрено

### Статус реализации
- ✅ **Разработка завершена** (версия 3.6.205.4)
- ⏳ **Ожидается демо на UAT** (проблемы с доступностью UAT среды у клиента)
- ⏳ **Настройка и тестирование** (в процессе)

## Критерии успеха

### Функциональные требования
1. **Отображение долгов по маршрутам**: Агент видит только свою часть задолженности
2. **Стоп-лист по фокусным группам**: Корректная работа стоп-листа в разрезе ФГ
3. **Проверка лимитов**: Валидация лимитов кредита по фокусной группе
4. **Отчетность**: Обновленные отчеты с учетом разделения по маршрутам

### Технические требования
1. **Производительность**: Время отклика не более 2 секунд
2. **Надежность**: 99.9% доступность функционала
3. **Совместимость**: Работа с существующими версиями МТ
4. **Безопасность**: Корректная авторизация и разграничение доступа

## Риски и ограничения

### Технические риски
1. **Производительность репликации**: Увеличение объема передаваемых данных
2. **Совместимость версий**: Необходимость обновления МТ до версии 3.6.205.4+
3. **Синхронизация данных**: Возможные расхождения между УС и Чикаго

### Бизнес-риски
1. **Обучение пользователей**: Необходимость обучения торговых агентов
2. **Изменение процессов**: Адаптация существующих бизнес-процессов
3. **Приемка клиентом**: Зависимость от доступности UAT среды

## Следующие шаги

### Ближайшие задачи
1. **Решение проблемы UAT**: Устранение проблем с доступностью UAT среды
2. **Демонстрация функционала**: Проведение демо для клиента
3. **Приемочное тестирование**: Тестирование на UAT среде
4. **Подготовка к продакшену**: Настройка производственной среды

### Долгосрочные планы
1. **Мониторинг**: Настройка мониторинга работы системы
2. **Оптимизация**: Анализ производительности и оптимизация при необходимости
3. **Развитие**: Планирование дальнейших улучшений функционала

## Контакты

- **Менеджер проекта**: Оздоган Татьяна
- **Заказчик**: Руднева Анастасия  
- **Команда разработки**: Foxtrot
- **Техническая поддержка**: Авдеева Галина

## Связанные документы

- [Техническое решение](TECHNICAL_SOLUTION_219908.md)
- [Руководство по тестированию](TESTING_GUIDE_219908.md)
- [Руководство по развертыванию](DEPLOYMENT_GUIDE_219908.md)
- [Пользовательская документация](USER_GUIDE_219908.md)
- [TDD в Confluence](https://confluence.systtech.ru/pages/viewpage.action?pageId=4049381975)
- [HLD в Confluence](https://confluence.systtech.ru/pages/viewpage.action?pageId=4043608048)

---
*Документ создан: 26.09.2025*  
*Версия: 1.0*  
*Статус: В работе*
