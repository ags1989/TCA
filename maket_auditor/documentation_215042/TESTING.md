# РўРµСЃС‚РёСЂРѕРІР°РЅРёРµ

## РћР±Р·РѕСЂ С‚РµСЃС‚РёСЂРѕРІР°РЅРёСЏ

РўРµСЃС‚РёСЂРѕРІР°РЅРёРµ СЃРёСЃС‚РµРјС‹ РёРЅС‚РµРіСЂР°С†РёРё РњРў СЃ Track and Trace РІРєР»СЋС‡Р°РµС‚ РІ СЃРµР±СЏ С‚РµСЃС‚РёСЂРѕРІР°РЅРёРµ С„СѓРЅРєС†РёРѕРЅР°Р»СЊРЅРѕСЃС‚Рё СЃРєР°РЅРёСЂРѕРІР°РЅРёСЏ QR-РєРѕРґРѕРІ, РІР°Р»РёРґР°С†РёРё РґР°РЅРЅС‹С…, СЃРѕР·РґР°РЅРёСЏ РѕС‚РіСЂСѓР·РѕРє Рё РёРЅС‚РµРіСЂР°С†РёРё СЃ РІРЅРµС€РЅРёРјРё СЃРёСЃС‚РµРјР°РјРё.

## РўРµСЃС‚РѕРІС‹Рµ СЃС†РµРЅР°СЂРёРё

### РР· User Story 225877 - РџРѕРґРєР»СЋС‡РµРЅРёРµ РґСЂ. С‚РёРїРѕРІ РѕРїР»Р°С‚С‹:

#### РЎС†РµРЅР°СЂРёР№ 1: Cold Sale (KГ¶Г§ГјrmЙ™ satД±ЕџД±)
**Р”Р°РЅРѕ:** Р’ РњРў РёР· Р§РёРєР°РіРѕ РїРѕСЃС‚СѓРїРёР» РґРѕРєСѓРјРµРЅС‚ Р—Р°РєР°Р·, РіРѕС‚РѕРІС‹Р№ Рє РѕС‚РіСЂСѓР·РєРµ

**РљРѕРіРґР°:** 
- РђРіРµРЅС‚ РЅР°С‡РёРЅР°РµС‚ РІРёР·РёС‚ РІ РўРў
- РђРіРµРЅС‚ РѕС‚РєСЂС‹РІР°РµС‚ С€Р°Рі СЃС†РµРЅР°СЂРёСЏ РћС‚РіСЂСѓР·РёС‚СЊ Р·Р°РєР°Р·
- РђРіРµРЅС‚ РІ СЃРїРёСЃРєРµ РІС‹Р±РёСЂР°РµС‚ Р—Р°РєР°Р·, РєРѕС‚РѕСЂС‹Р№ РЅРµРѕР±С…РѕРґРёРјРѕ РѕС‚РіСЂСѓР·РёС‚СЊ

**РўРѕРіРґР°:**
- РћС‚РєСЂС‹РІР°РµС‚СЃСЏ СЌРєСЂР°РЅ "РЎРєР°РЅРёСЂРѕРІР°РЅРёРµ QR-РєРѕРґРѕРІ"
- РђРіРµРЅС‚ СЃРєР°РЅРёСЂСѓРµС‚ РІСЃРµ QR-РєРѕРґС‹ С‚РѕРІР°СЂРѕРІ РёР· РґРѕРєСѓРјРµРЅС‚Р° Р—Р°РєР°Р·
- РљР°Р¶РґС‹Р№ QR-РєРѕРґ РѕС‚РїСЂР°РІР»СЏРµС‚СЃСЏ РЅР° РїСЂРѕРІРµСЂРєСѓ:
  - РЅР° РЅР°Р»РёС‡РёРµ С‚РѕРІР°СЂР° РІ Р±Р°Р·Рµ РґР°РЅРЅС‹С…
  - РЅР° РЅР°Р»РёС‡РёРµ РѕСЃС‚Р°С‚РєРѕРІ С‚РѕРІР°СЂР°
  - РЅР° РІР°Р»РёРґРЅРѕСЃС‚СЊ РєРѕРґР° РІ РўРЅРў

#### РЎС†РµРЅР°СЂРёР№ 2: Ecomm
**Р”Р°РЅРѕ:** Р’ РњРў РёР· Р§РёРєР°РіРѕ РїРѕСЃС‚СѓРїРёР» РґРѕРєСѓРјРµРЅС‚ Р—Р°РєР°Р·, РіРѕС‚РѕРІС‹Р№ Рє РѕС‚РіСЂСѓР·РєРµ

**РљРѕРіРґР°:**
- РђРіРµРЅС‚ РІС‹Р±РёСЂР°РµС‚ ecomm Р—Р°РєР°Р· РґР»СЏ РѕС‚РіСЂСѓР·РєРё
- РђРіРµРЅС‚ СЃРєР°РЅРёСЂСѓРµС‚ QR-РєРѕРґС‹ С‚РѕРІР°СЂРѕРІ

**РўРѕРіРґР°:**
- РњРў РѕС‚РїСЂР°РІР»СЏРµС‚ РґР°РЅРЅС‹Рµ РѕР± РѕС‚РіСЂСѓР¶РµРЅРЅС‹С… С‚РѕРІР°СЂР°С… РїРѕ СЃРґРµР»РєРµ ecomm (РІ api /makeshipping/ ordertype=1)
- Р”РѕРєСѓРјРµРЅС‚ РћС‚РіСЂСѓР·РєР° РєРѕСЂСЂРµРєС‚РЅРѕ СЃРѕС…СЂР°РЅСЏРµС‚СЃСЏ РІ РњРў

### РР· РѕС€РёР±РєРё 232620 - Р’Р°Р»РёРґР°С†РёСЏ QR-РєРѕРґРѕРІ:

#### РЎС†РµРЅР°СЂРёР№ 3: Р”РѕР±Р°РІР»РµРЅРёРµ С‚РѕРІР°СЂР° СЃ РѕС€РёР±РѕС‡РЅС‹Рј СЃС‚Р°С‚СѓСЃРѕРј
**Р”Р°РЅРѕ:** РўРѕРІР°СЂ РµСЃС‚СЊ РІ Р±Р°Р·Рµ РњРў Рё Р±Р°Р·Рµ СЃРµСЂРІРёСЃР° T&T, РЅРѕ РЅРµ Р°РєС‚РёРІРёСЂРѕРІР°РЅ

**РљРѕРіРґР°:** РђРіРµРЅС‚ РѕС‚СЃРєР°РЅРёСЂРѕРІР°Р» С‚РѕРІР°СЂ

**РўРѕРіРґР°:** 
- РўРѕРІР°СЂ РїРѕРїР°РґР°РµС‚ РІ СЃРїРёСЃРѕРє РѕС‚СЃРєР°РЅРёСЂРѕРІР°РЅРЅС‹С… С‚РѕРІР°СЂРѕРІ СЃ РѕС€РёР±РѕС‡РЅС‹Рј СЃС‚Р°С‚СѓСЃРѕРј
- РћС‚РѕР±СЂР°Р¶Р°РµС‚СЃСЏ СЃРѕРѕС‚РІРµС‚СЃС‚РІСѓСЋС‰РµРµ СЃРѕРѕР±С‰РµРЅРёРµ РѕР± РѕС€РёР±РєРµ

**РўРµСЃС‚РѕРІС‹Рµ РґР°РЅРЅС‹Рµ:**
- РќРµ РІР°Р»РёРґРЅС‹Р№ Р±Р»РѕРє (activated: false)
- РќРµ РІР°Р»РёРґРЅР°СЏ РїР°С‡РєР° (withdraw_type = 1)
- Р’Р°Р»РёРґРЅР°СЏ РїР°С‡РєР° (activated: true, withdraw_type = 0)

### РР· РѕС€РёР±РєРё 234424 - Cold Sale РѕРїР»Р°С‚Р°:

#### РЎС†РµРЅР°СЂРёР№ 4: РЎРѕС…СЂР°РЅРµРЅРёРµ РґРѕРєСѓРјРµРЅС‚Р° РїСЂРё РѕРїР»Р°С‚Рµ С‚РёРїР° coldSale
**Р”Р°РЅРѕ:** РЎРѕР·РґР°РЅ РґРѕРєСѓРјРµРЅС‚ РѕС‚РіСЂСѓР·РєР° СЃ С‚РёРїРѕРј РѕРїР»Р°С‚С‹ "KГ¶Г§ГјrmЙ™ satД±Еџ (order type 0 - cold sale)"

**РљРѕРіРґР°:** РђРіРµРЅС‚ РЅР°Р¶РёРјР°РµС‚ СЃРѕС…СЂР°РЅРёС‚СЊ

**РўРѕРіРґР°:**
- РњРў РќР• РѕС‚РїСЂР°РІР»СЏРµС‚ Р·Р°РїСЂРѕСЃС‹ РЅР° СЃС‚Р°С‚СѓСЃ РѕРїР»Р°С‚С‹
- Р”РѕРєСѓРјРµРЅС‚ РѕС‚РіСЂСѓР·РєРё СЃРѕС…СЂР°РЅСЏРµС‚СЃСЏ РїСЂРё СѓСЃРїРµС€РЅРѕРј СЂРµР·СѓР»СЊС‚Р°С‚Рµ Р±РµР· РѕРїСЂРѕСЃР° СЃС‚Р°С‚СѓСЃР° РѕРїР»Р°С‚С‹

#### РЎС†РµРЅР°СЂРёР№ 5: Ecomm РѕРїР»Р°С‚Р°
**Р”Р°РЅРѕ:** РЎРѕР·РґР°РЅ РґРѕРєСѓРјРµРЅС‚ РѕС‚РіСЂСѓР·РєР° СЃ С‚РёРїРѕРј РѕРїР»Р°С‚С‹ "ECOMM satД±ЕџД±"

**РљРѕРіРґР°:** РђРіРµРЅС‚ РЅР°Р¶РёРјР°РµС‚ СЃРѕС…СЂР°РЅРёС‚СЊ

**РўРѕРіРґР°:**
- РњРў РѕС‚РїСЂР°РІР»СЏРµС‚ Р·Р°РїСЂРѕСЃС‹ РЅР° СЃС‚Р°С‚СѓСЃ РѕРїР»Р°С‚С‹
- Р”РѕРєСѓРјРµРЅС‚ СЃРѕС…СЂР°РЅСЏРµС‚СЃСЏ С‚РѕР»СЊРєРѕ РїРѕСЃР»Рµ РїРѕРґС‚РІРµСЂР¶РґРµРЅРёСЏ РѕРїР»Р°С‚С‹

## Р РµР·СѓР»СЊС‚Р°С‚С‹ С‚РµСЃС‚РёСЂРѕРІР°РЅРёСЏ

### РЈСЃРїРµС€РЅС‹Рµ С‚РµСЃС‚С‹:

#### Cold Sale РѕС‚РіСЂСѓР·РєР°:
- вњ… РЈСЃРїРµС€РЅР°СЏ РѕС‚РіСЂСѓР·РєР° С‚РёРї РѕРїР»Р°С‚С‹ KГ¶Г§ГјrmЙ™ satД±Еџ
- вњ… Р”РѕРєСѓРјРµРЅС‚ СЃРѕС…СЂР°РЅСЏРµС‚СЃСЏ Р±РµР· РѕРїСЂРѕСЃР° СЃС‚Р°С‚СѓСЃР° РѕРїР»Р°С‚С‹
- вњ… Р”Р°РЅРЅС‹Рµ РєРѕСЂСЂРµРєС‚РЅРѕ РїРµСЂРµРґР°СЋС‚СЃСЏ РІ T&T

#### Ecomm РѕС‚РіСЂСѓР·РєР°:
- вњ… РЈСЃРїРµС€РЅР°СЏ РѕС‚РіСЂСѓР·РєР° С‚РёРї РѕРїР»Р°С‚С‹ ECOMM satД±ЕџД±
- вњ… РЎС‚Р°С‚СѓСЃ РѕРїР»Р°С‚С‹ РєРѕСЂСЂРµРєС‚РЅРѕ РїСЂРѕРІРµСЂСЏРµС‚СЃСЏ
- вњ… Р”РѕРєСѓРјРµРЅС‚ СЃРѕС…СЂР°РЅСЏРµС‚СЃСЏ РїРѕСЃР»Рµ РїРѕРґС‚РІРµСЂР¶РґРµРЅРёСЏ РѕРїР»Р°С‚С‹

#### Р’Р°Р»РёРґР°С†РёСЏ QR-РєРѕРґРѕРІ:
- вњ… Р’Р°Р»РёРґРЅС‹Рµ РєРѕРґС‹ РґРѕР±Р°РІР»СЏСЋС‚СЃСЏ РІ СЃРїРёСЃРѕРє РѕС‚СЃРєР°РЅРёСЂРѕРІР°РЅРЅС‹С… С‚РѕРІР°СЂРѕРІ
- вњ… РќРµРІР°Р»РёРґРЅС‹Рµ РєРѕРґС‹ РґРѕР±Р°РІР»СЏСЋС‚СЃСЏ РІ СЃРїРёСЃРѕРє СЃ РѕС€РёР±РѕС‡РЅС‹Рј СЃС‚Р°С‚СѓСЃРѕРј
- вњ… РћС€РёР±РєРё РІР°Р»РёРґР°С†РёРё РєРѕСЂСЂРµРєС‚РЅРѕ РѕС‚РѕР±СЂР°Р¶Р°СЋС‚СЃСЏ РїРѕР»СЊР·РѕРІР°С‚РµР»СЋ

### РСЃРїСЂР°РІР»РµРЅРЅС‹Рµ РѕС€РёР±РєРё:

#### РћС€РёР±РєР° 232620 - Р­Р»РµРјРµРЅС‚С‹ РЅРµ РїСЂРѕС€РµРґС€РёРµ РІР°Р»РёРґР°С†РёСЋ:
**РџСЂРѕР±Р»РµРјР°:** РќРµРїСЂР°РІРёР»СЊРЅРѕРµ СѓСЃР»РѕРІРёРµ РїСЂРё РєРѕС‚РѕСЂРѕРј С‚РѕРІР°СЂ РЅРµ РїРѕРїР°РґР°РµС‚ РІ СЃРїРёСЃРѕРє СЃ РѕС€РёР±РѕС‡РЅС‹РјРё СЃС‚Р°С‚СѓСЃР°РјРё.

**РСЃРїСЂР°РІР»РµРЅРёРµ:**
`javascript
// РЎС‚Р°СЂРѕРµ СѓСЃР»РѕРІРёРµ
(!validatinResult.success && 'errorCode' in validatinResult)

// РќРѕРІРѕРµ СѓСЃР»РѕРІРёРµ  
(!validatinResult.success && skuData === null)
`

**Р РµР·СѓР»СЊС‚Р°С‚:** РўРѕРІР°СЂС‹ СЃ РѕС€РёР±РѕС‡РЅС‹Рј СЃС‚Р°С‚СѓСЃРѕРј С‚РµРїРµСЂСЊ РєРѕСЂСЂРµРєС‚РЅРѕ РґРѕР±Р°РІР»СЏСЋС‚СЃСЏ РІ СЃРїРёСЃРѕРє.

#### РћС€РёР±РєР° 234424 - Cold Sale РѕРїР»Р°С‚Р°:
**РџСЂРѕР±Р»РµРјР°:** РњРў РѕС‚РїСЂР°РІР»СЏР»Р° Р·Р°РїСЂРѕСЃС‹ РЅР° СЃС‚Р°С‚СѓСЃ РѕРїР»Р°С‚С‹ РґР»СЏ cold sale.

**РСЃРїСЂР°РІР»РµРЅРёРµ:**
`csharp
// Р”РѕР±Р°РІР»РµРЅРѕ СѓСЃР»РѕРІРёРµ РґР»СЏ cold sale
if (orderType == 0) // Cold Sale
{
    result.Immediate = true; // РќРµ РѕРїСЂР°С€РёРІР°С‚СЊ СЃС‚Р°С‚СѓСЃ РѕРїР»Р°С‚С‹
}
`

**Р РµР·СѓР»СЊС‚Р°С‚:** Cold sale РѕС‚РіСЂСѓР·РєРё СЃРѕС…СЂР°РЅСЏСЋС‚СЃСЏ Р±РµР· РѕРїСЂРѕСЃР° СЃС‚Р°С‚СѓСЃР° РѕРїР»Р°С‚С‹.

## Р РµРєРѕРјРµРЅРґР°С†РёРё РїРѕ С‚РµСЃС‚РёСЂРѕРІР°РЅРёСЋ

### 1. РўРµСЃС‚РёСЂРѕРІР°РЅРёРµ СЃРєР°РЅРёСЂРѕРІР°РЅРёСЏ QR-РєРѕРґРѕРІ:
- РўРµСЃС‚РёСЂРѕРІР°С‚СЊ СЃ СЂР°Р·Р»РёС‡РЅС‹РјРё С‚РёРїР°РјРё QR-РєРѕРґРѕРІ
- РџСЂРѕРІРµСЂСЏС‚СЊ РѕР±СЂР°Р±РѕС‚РєСѓ РЅРµРІР°Р»РёРґРЅС‹С… РєРѕРґРѕРІ
- РўРµСЃС‚РёСЂРѕРІР°С‚СЊ СЂР°Р±РѕС‚Сѓ РІ СѓСЃР»РѕРІРёСЏС… РїР»РѕС…РѕРіРѕ РёРЅС‚РµСЂРЅРµС‚Р°

### 2. РўРµСЃС‚РёСЂРѕРІР°РЅРёРµ С‚РёРїРѕРІ РѕРїР»Р°С‚С‹:
- РџСЂРѕРІРµСЂРёС‚СЊ РІСЃРµ С‚СЂРё С‚РёРїР°: Cold Sale, Ecomm, Bonus Sale
- РЈР±РµРґРёС‚СЊСЃСЏ РІ РєРѕСЂСЂРµРєС‚РЅРѕР№ РѕР±СЂР°Р±РѕС‚РєРµ РєР°Р¶РґРѕРіРѕ С‚РёРїР°
- РџСЂРѕРІРµСЂРёС‚СЊ Р»РѕРіРёРєСѓ РѕРїСЂРѕСЃР° СЃС‚Р°С‚СѓСЃР° РѕРїР»Р°С‚С‹

### 3. РўРµСЃС‚РёСЂРѕРІР°РЅРёРµ РёРЅС‚РµРіСЂР°С†РёРё СЃ T&T:
- РўРµСЃС‚РёСЂРѕРІР°С‚СЊ Р°РІС‚РѕСЂРёР·Р°С†РёСЋ РІ T&T
- РџСЂРѕРІРµСЂСЏС‚СЊ РѕР±СЂР°Р±РѕС‚РєСѓ РѕС€РёР±РѕРє API
- РўРµСЃС‚РёСЂРѕРІР°С‚СЊ retry РјРµС…Р°РЅРёР·Рј

### 4. РўРµСЃС‚РёСЂРѕРІР°РЅРёРµ РїСЂРѕРёР·РІРѕРґРёС‚РµР»СЊРЅРѕСЃС‚Рё:
- РќР°РіСЂСѓР·РѕС‡РЅРѕРµ С‚РµСЃС‚РёСЂРѕРІР°РЅРёРµ API
- РўРµСЃС‚РёСЂРѕРІР°РЅРёРµ СЃ Р±РѕР»СЊС€РёРј РєРѕР»РёС‡РµСЃС‚РІРѕРј QR-РєРѕРґРѕРІ
- РџСЂРѕРІРµСЂРєР° Р»РёРјРёС‚РѕРІ T&T API (2 Р·Р°РїСЂРѕСЃР° РІ СЃРµРєСѓРЅРґСѓ)

### 5. РўРµСЃС‚РёСЂРѕРІР°РЅРёРµ РїРѕР»СЊР·РѕРІР°С‚РµР»СЊСЃРєРѕРіРѕ РёРЅС‚РµСЂС„РµР№СЃР°:
- РџСЂРѕРІРµСЂРєР° РѕС‚РѕР±СЂР°Р¶РµРЅРёСЏ СЃС‚Р°С‚СѓСЃРѕРІ СЃРєР°РЅРёСЂРѕРІР°РЅРёСЏ
- РўРµСЃС‚РёСЂРѕРІР°РЅРёРµ РѕР±СЂР°Р±РѕС‚РєРё РѕС€РёР±РѕРє РїРѕР»СЊР·РѕРІР°С‚РµР»РµРј
- РџСЂРѕРІРµСЂРєР° РЅР°РІРёРіР°С†РёРё РјРµР¶РґСѓ СЌРєСЂР°РЅР°РјРё

## РђРІС‚РѕРјР°С‚РёР·РёСЂРѕРІР°РЅРЅРѕРµ С‚РµСЃС‚РёСЂРѕРІР°РЅРёРµ

### Unit С‚РµСЃС‚С‹:
`csharp
[Test]
public void ValidateQRCode_InvalidCode_ReturnsError()
{
    // Arrange
    var invalidCode = "invalid123";
    
    // Act
    var result = _qrCodeValidator.Validate(invalidCode);
    
    // Assert
    Assert.IsFalse(result.IsValid);
    Assert.AreEqual("Code not found", result.ErrorMessage);
}
`

### Integration С‚РµСЃС‚С‹:
`csharp
[Test]
public async Task CreateShipment_ColdSale_DoesNotPollPayment()
{
    // Arrange
    var shipment = new ShipmentRequest { OrderType = 0 };
    
    // Act
    var result = await _shipmentService.CreateAsync(shipment);
    
    // Assert
    Assert.IsTrue(result.Immediate);
    _paymentService.Verify(x => x.PollStatus(It.IsAny<string>()), Times.Never);
}
`

### E2E С‚РµСЃС‚С‹:
`javascript
describe('QR Code Scanning', () => {
    it('should scan valid QR code and add to list', async () => {
        // Arrange
        const validQRCode = '10000001';
        
        // Act
        await scanQRCode(validQRCode);
        
        // Assert
        expect(getScannedItems()).toContain(validQRCode);
        expect(getErrorItems()).toHaveLength(0);
    });
});
`

---
*РўРµСЃС‚РѕРІС‹Рµ СЃС†РµРЅР°СЂРёРё РѕСЃРЅРѕРІР°РЅС‹ РЅР° User Story 225877 Рё РёСЃРїСЂР°РІР»РµРЅРЅС‹С… РѕС€РёР±РєР°С… 232620, 234424*
